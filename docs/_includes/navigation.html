<nav class="site-nav">
  <ul class="nav-list">
    {% if site.autogenerated_navigation %}
    {% for item in site.autogenerated_navigation %}
    <li
      class="nav-item{% if page.url == item.url or page.parent == item.title or page.grand_parent == item.title %} active{% endif %}">
      <a href="{{ item.url | relative_url }}">{{ item.title }}</a>

      {% if item.has_children and item.children %}
      <ul class="nav-sublist">
        {% for child in item.children %}
        <li class="nav-subitem{% if page.url == child.url or page.parent == child.title %} active{% endif %}">
          <a href="{{ child.url | relative_url }}">{{ child.title }}</a>

          {% if child.has_children and child.children %}
          <ul class="nav-subsublist">
            {% for grandchild in child.children %}
            <li class="nav-subsubitem{% if page.url == grandchild.url %} active{% endif %}">
              <a href="{{ grandchild.url | relative_url }}">{{ grandchild.title }}</a>
            </li>
            {% endfor %}
          </ul>
          {% endif %}
        </li>
        {% endfor %}
      </ul>
      {% endif %}
    </li>
    {% endfor %}
    {% else %}
    <!-- Fallback navigation from site.navigation -->
    {% for item in site.navigation %}
    <li class="nav-item{% if page.url == item.url %} active{% endif %}">
      <a href="{{ item.url | relative_url }}">{{ item.title }}</a>
    </li>
    {% endfor %}
    {% endif %}
  </ul>
</nav>